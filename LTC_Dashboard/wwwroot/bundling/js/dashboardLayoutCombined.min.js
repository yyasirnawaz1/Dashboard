var CardsDraggable=function(){var _componentSortable=function(){if(!$().sortable){console.warn("Warning - jquery_ui.js components are not loaded.");return}$(".row-sortable").sortable({connectWith:".row-sortable",items:".card",helper:"original",cursor:"move",handle:"[data-action=move]",revert:100,containment:".content-wrapper",forceHelperSize:!0,placeholder:"sortable-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",start:function(e,ui){ui.placeholder.height(ui.item.outerHeight())}});$(".column-card-sortable").sortable({connectWith:".column-sortable",items:".card",helper:"original",cursor:"move",handle:"[data-action=move]",revert:100,containment:".content-wrapper",forceHelperSize:!0,placeholder:"sortable-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",start:function(e,ui){ui.placeholder.height(ui.item.outerHeight())}});$(".sortable-exclude").sortable({connectWith:".custom-sortable",items:".card:not(.skip-sort)",helper:"original",cursor:"move",handle:"[data-action=move]",revert:100,containment:".content-wrapper",forceHelperSize:!0,placeholder:"sortable-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",start:function(e,ui){ui.placeholder.height(ui.item.outerHeight())}});$(".sortable-heading").sortable({connectWith:".heading-sortable",items:".card",helper:"original",cursor:"move",handle:".card-title, [data-action=move]",revert:100,containment:".content-wrapper",forceHelperSize:!0,placeholder:"sortable-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",start:function(e,ui){ui.placeholder.height(ui.item.outerHeight())}});$(".sortable-card").sortable({connectWith:".card-sortable",items:".card",helper:"original",cursor:"move",revert:100,containment:".content-wrapper",forceHelperSize:!0,placeholder:"sortable-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",start:function(e,ui){ui.placeholder.height(ui.item.outerHeight())}});$(".elements-sortable").sortable({connectWith:".elements-sortable",items:".card-heading, .table-responsive",helper:"original",cursor:"move",handle:"[data-action=move]",revert:100,containment:".content-wrapper",forceHelperSize:!0,placeholder:"sortable-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",start:function(e,ui){ui.placeholder.height(ui.item.outerHeight())}})};return{init:function(){_componentSortable()}}}(),Dashboard,DashboardSpreadSheet;document.addEventListener("DOMContentLoaded",function(){CardsDraggable.init()});var UserPermissions=null,isUserLoggedIn=null,Layout={currentModel:"",ProfileSave:function(){$("#changeuserprofileform").submit(function(e){e.preventDefault();$form=$(this);var SUBMITURL=window.location.origin+"/Account/Update";console.log(SUBMITURL);Layout.showLoader();$.ajax({url:SUBMITURL,method:"POST",data:$("#changeuserprofileform").serialize(),datatype:"html",success:function(){Layout.hideLoader();$("#userprofileModal").modal("hide")},error:function(){Layout.hideLoader()}})})},PasswordSave:function(){$("#changepasswordform").submit(function(e){e.preventDefault();$form=$(this);var SUBMITURL=window.location.origin+"/Account/ChangePassword";$.ajax({url:SUBMITURL,method:"POST",data:$("#changepasswordform").serialize(),datatype:"html",success:function(){$("#changePasswordModal").modal("hide");$("#txtCurrentPassword").val("");$("#txtNewPassword").val("");$("#txtConfirmPassword").val("")},error:function(){}})})},loadCornerMenuControl:function(){$(".trigger").click(function(){$(".rotationMenu").toggleClass("active")})},openMenu:function(name){$(".trigger").click();var url="";name=="dashboard"?url="/dashboard/index":name=="report"?url="/Report/index":name=="survey"?url="/Survey/index":name=="form"?url="/Form/index":name=="officemanagement"?url="/OfficeManagement/index":name=="newsletter"&&(url="/NewsLetter/Home");window.open(url,"_blank")},togglePreviewButton:function(obj,parent){var isPreviewHidden=$(obj).hasClass("isPreviewHidden");isPreviewHidden?($(obj).removeClass("isPreviewHidden"),$(obj).html('<span class="fa fa-eye-slash"><\/span>'),$(obj).addClass("btn-danger"),$(obj).removeClass("btn-primary"),$("#"+parent).removeClass("toggleDivHidden"),$("#"+parent+" > div:nth(0)").removeClass("col-lg-12 col-md-12 col-sm-12 col-xs-12"),$("#"+parent+" > div:nth(0)").addClass("col-lg-6 col-md-6 col-sm-6 col-xs-6"),$("#"+parent+" > div:nth(2)").addClass("col-lg-6 col-md-6 col-sm-6 col-xs-6")):($(obj).addClass("isPreviewHidden"),$(obj).html('<span class="fa fa-eye"><\/span>'),$(obj).removeClass("btn-danger"),$(obj).addClass("btn-primary"),$("#"+parent).addClass("toggleDivHidden"),$("#"+parent+" > div:nth(0)").addClass("col-lg-12 col-md-12 col-sm-12 col-xs-12"),$("#"+parent+" > div:nth(0)").removeClass("col-lg-6 col-md-6 col-sm-6 col-xs-6"),$("#"+parent+" > div:nth(2)").removeClass("col-lg-6 col-md-6 col-sm-6 col-xs-6"))},renderFormDesignerInIframe:function(content,id){var iframe=document.getElementById(id),iframeWin=iframe.contentWindow||iframe,iframeDoc=iframe.contentDocument||iframeWin.document;iframeDoc.open();iframeDoc.write("<html><head>");iframeDoc.write("<\/head><body>");iframeDoc.write('<link rel="stylesheet" href="/Resources/theme/css/styles.css"><script type="text/javascript" src="/Resources/theme/js/vendor/jquery/jquery.min.js"><\/script><script type="text/javascript" src="/Resources/theme/js/vendor/jquery/jquery-ui.min.js"><\/script><script type="text/javascript" src="/Resources/theme/js/vendor/bootstrap/bootstrap.min.js"><\/script><script src="/Resources/FormDesigner/assets/js/form-render.min.js"><\/script><link href="/Resources/FormDesigner/assets/css/RateYo/RateYo.css" rel="stylesheet" /><script src="/Resources/FormDesigner/assets/js/Rateyo/jquery.rateyo.min.js"><\/script><link href="/Resources/Signature/jquery.signature.css" rel="stylesheet" /><script src="/Resources/Signature/jquery.signature.js"><\/script>');iframeDoc.write('<script src="/Scripts/SharedJS/RenderContent.js"><\/script>');iframeDoc.write('<div id="render-container"  style="padding: 30px;"><\/div>');iframeDoc.write('<script type="text/javascript">$(document).ready(function () {var content = '+content+";  RenderContent.RenderContentInIframe(content);});<\/script>");iframeDoc.write("<\/body><\/html>");iframeDoc.close()},renderContentInIframe:function(content,id){var iframe=document.getElementById(id);iframe=iframe.contentWindow||iframe.contentDocument.document||iframe.contentDocument;iframe.document.open();iframe.document.write(content);iframe.document.close()},loadUserData:function(){var DATAURL=window.location.origin+"/Home/GetUserdata";$.ajax({type:"POST",url:DATAURL,contentType:"application/json; charset=utf-8",dataType:"json",success:function(response){response.Success==!0&&($("#userprofileModal").modal("show"),$("#txtSalutation").val(response.Data.Salutation),$("#txtInitials").val(response.Data.Initials),$("#txtFirstName").val(response.Data.FirstName),$("#txtLastName").val(response.Data.LastName),$("#txtPhone").val(response.Data.Phone),$("#txtFax").val(response.Data.Fax),$("#txtAddressLine1").val(response.Data.AddressLine1),$("#txtAddressLine2").val(response.Data.AddressLine2),$("#txtAddressLine3").val(response.Data.AddressLine3),$("#txtCity").val(response.Data.City),$("#txtProvince").val(response.Data.Province),$("#txtCountry").val(response.Data.Country),$("#txtPostalCode").val(response.Data.PostalCode),$("#txtDoctorId").val(response.Data.DoctorID))},failure:function(){},error:function(){}})},updateUserProfile:function(){if($("#txtSalutation").val()==""||$("#txtInitials").val()==""||$("#txtFirstName").val()==""||$("#txtLastName").val()==""||$("#txtPhone").val()==""||$("#txtFax").val()==""||$("#txtAddressLine1").val()==""||$("#txtCity").val()==""||$("#txtProvince").val()==""||$("#txtCountry").val()==""||$("#txtPostalCode").val()=="")alert("Invalid Data Entered");else{var SUBMITURL=window.location.origin+"/Home/UpdateProfile";$.ajax({url:SUBMITURL,method:"POST",data:{Salutation:$("#txtSalutation").val(),Initials:$("#txtInitials").val(),FirstName:$("#txtFirstName").val(),LastName:$("#txtLastName").val(),Phone:$("#txtPhone").val(),Fax:$("#txtFax").val(),AddressLine1:$("#txtAddressLine1").val(),AddressLine2:$("#txtAddressLine2").val(),AddressLine3:$("#txtAddressLine3").val(),City:$("#txtCity").val(),Province:$("#txtProvince").val(),Country:$("#txtCountry").val(),PostalCode:$("#txtPostalCode").val(),DoctorID:$("#txtDoctorId").val()},success:function(data){data.Success?($("#userprofileModal").modal("hide"),alert("profile updated")):alert(data.Data)},error:function(args){alert(args)}})}},updatePassword:function(){if($("#txtCurrentPassword").val()==""||$("#txtNewPassword").val()==""||$("#txtNewPassword").val()!=$("#txtConfirmPassword").val())alert("Invalid Data Entered");else{var SUBMITURL=window.location.origin+"/Home/ChangePassword";$.ajax({url:SUBMITURL,method:"POST",data:{CurrentPassword:$("#txtCurrentPassword").val(),NewPassword:$("#txtNewPassword").val()},success:function(data){data.Success?($("#changePasswordModal").modal("hide"),$("#txtCurrentPassword").val(""),$("#txtNewPassword").val(""),$("#txtConfirmPassword").val(""),alert("password updated")):alert(data.Data)},error:function(){alert("Unable to change password")}})}},circularProgressBar:function(){$(".circularBar .progress").each(function(){var value=$(this).attr("data-value"),left=$(this).find(".progress-left .progress-bar"),right=$(this).find(".progress-right .progress-bar");value>0&&(value<=50?right.css("transform","rotate("+Layout.percentageToDegrees(value)+"deg)"):(right.css("transform","rotate(180deg)"),left.css("transform","rotate("+Layout.percentageToDegrees(value-50)+"deg)")))})},percentageToDegrees:function(percentage){return percentage/100*360},closeTab:function(id){var tabContentId=$("#tab-"+id+"> a").attr("href");$("#tab-"+id).hide();$(tabContentId).hide();$("#Tabs a:visible:first").length>0?setTimeout(function(){$("#Tabs a:visible:first").click()},1e3):$("#nodataDiv").show()},showLoader:function(){$("body").block({message:'<i class="icon-spinner4 spinner"><\/i>',overlayCSS:{opacity:.9,cursor:"wait"},css:{border:0,padding:0,color:"#fff",backgroundColor:"transparent"}})},hideLoader:function(){$.unblockUI()},showCardLoader:function(id){$("#"+id).block({message:'<i class="icon-spinner9 spinner"><\/i>',overlayCSS:{backgroundColor:"#1B2024",opacity:.85,cursor:"wait"},css:{border:0,padding:0,backgroundColor:"none",color:"#fff"}})},hideCardLoader:function(id){$("#"+id).unblock()},storageChange:function(event){event.key==="logged_in"&&event.value==!1&&$(location).attr("href","/Account/LogOut")},checkUserLogin:function(){$.ajax({type:"POST",async:!0,data:{},url:window.location.origin+"/Account/IsUserLoggedIn",success:function(data){data==!0?window.localStorage.setItem("logged_in",!0):window.localStorage.setItem("logged_in",!1)},error:function(){window.localStorage.setItem("logged_in",!1)}})},SelectPicker:function(id,setting){$("#"+id).selectpicker(setting)}};$(document).ready(function(){window.addEventListener("storage",Layout.storageChange,!1);$.get("/Home/GetUserPermissions",function(data){UserPermissions=data;Layout.hideLoader();window.localStorage.setItem("logged_in",!0);try{Login!=null&&$("#isLoginPage").val()!=""&&UserPermissions!=null&&UserPermissions.isDisplaySummary&&Login.showCards()}catch(e){}try{}catch(e){}}).fail(function(){window.localStorage.setItem("logged_in",!1);Layout.hideLoader()});$("#thePreviewPanel").on("hidden.bs.modal",function(){Layout.currentModel!=""&&$("#"+Layout.currentModel).modal("show")});$("#thePreviewPanel").on("shown.bs.modal",function(){$("#publicSurveyModal").data("bs.modal")&&$("#publicSurveyModal").data("bs.modal").isShown?Layout.currentModel="publicSurveyModal":$("#publicFormModal").data("bs.modal")&&$("#publicFormModal").data("bs.modal").isShown?Layout.currentModel="publicFormModal":$("#PreDefinedNewsLetter").data("bs.modal")&&$("#PreDefinedNewsLetter").data("bs.modal").isShown&&(Layout.currentModel="PreDefinedNewsLetter");Layout.currentModel!=""&&$("#"+Layout.currentModel).modal("hide")});Layout.loadCornerMenuControl()});Dashboard={setting:{isBreakdownTable:!1,isSpreadsheetTale:!1,loadedChartName:""},charts:[],loadedCharts:[],loadedPatients:[],breakdownGrid:null,chartsDetailData:null,mapping:null,breakdownTable:null,breakdownTableConfiguration:null,breakdownTableBasic:null,officeList:null,chartType:"PracticeMetrics",selectionHTML:'<div class="col-12 draggable order-{order} order-last" data-id="{id}" data-name="{name}" data-title="{title}" data-position="{position}" data-order="{order}" data-filtertypes="{filtertypes}"><div class="nav-link"><i class="{icon}"><\/i>{title}<\/div><\/div>',filterTypeHTML:'<option value="{value}">{name}<\/option> ',NewPatient:'<div id="cardStart-{name}" class="col col-lg-3 col-md-4 col-sm-6 cardStart order-{order}"><div id="card-{name}" class="card bg-blue-400"><div class="card-body dashboardCard pt-1 pb-1"><div class="d-flex cardHeading"><h3 class="font-weight-semibold mb-0 font-variant-smallCaps">{heading}<\/h3><div class="list-icons ml-auto"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><div class="d-flex justify-content-center cardContent"><span id="card-{name}-value" class="font-weight-semibold mb-0 font-size-xs">0<\/span><\/div><\/div><\/div><\/div>',TotalNetProduction:'<div id="cardStart-{name}" class="col col-lg-3 col-md-4 col-sm-6 cardStart order-{order}"><div id="card-{name}" class="card bg-teal-400"><div class="card-body dashboardCard pt-1 pb-1"><div class="d-flex cardHeading"><h3 class="font-weight-semibold mb-0 font-variant-smallCaps">{heading}<\/h3><div class="list-icons ml-auto"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><div class="d-flex justify-content-center cardContent"><span id="card-{name}-value" class="font-weight-semibold mb-0 font-size-xs">0<\/span><\/div><\/div><\/div><\/div>',TotalGrossProduction:'<div id="cardStart-{name}" class="col col-lg-3 col-md-4 col-sm-6 cardStart order-{order}"><div id="card-{name}" class="card bg-teal-400"><div class="card-body dashboardCard pt-1 pb-1"><div class="d-flex cardHeading"><h3 class="font-weight-semibold mb-0 font-variant-smallCaps">{heading}<\/h3><div class="list-icons ml-auto"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><div class="d-flex justify-content-center cardContent"><span id="card-{name}-value" class="font-weight-semibold mb-0 font-size-xs">0<\/span><\/div><\/div><\/div><\/div>',TotalPaymentReceipt:'<div id="cardStart-{name}" class="col col-lg-3 col-md-4 col-sm-6 cardStart order-{order}"><div id="card-{name}" class="card bg-pink-400"><div class="card-body dashboardCard pt-1 pb-1"><div class="d-flex cardHeading"><h3 class="font-weight-semibold mb-0 font-variant-smallCaps">{heading}<\/h3><div class="list-icons ml-auto"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><div class="d-flex justify-content-center cardContent"><span id="card-{name}-value" class="font-weight-semibold mb-0 font-size-xs">0<\/span><\/div><div class="d-flex justify-content-end cardContent"><img src="/Resources/Images/pivotIcon.svg" onclick="Dashboard.loadChartBreakdownData(\'{name}\',\'{filtertypes}\')" class="pivoticon" /><img src="/Resources/Images/spreadsheetIcon.svg" onclick="DashboardSpreadSheet.loadChartSpreadSheetData(\'{name}\',\'{filtertypes}\')" class="spreadsheeticon" /><\/div><\/div><\/div><\/div>',TotalNetPaymentReceipt:'<div id="cardStart-{name}" class="col col-lg-3 col-md-4 col-sm-6 cardStart order-{order}"><div id="card-{name}" class="card bg-blue-400"><div class="card-body dashboardCard pt-1 pb-1"><div class="d-flex cardHeading"><h3 class="font-weight-semibold mb-0 font-variant-smallCaps">{heading}<\/h3><div class="list-icons ml-auto"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><div class="d-flex justify-content-center cardContent"><span id="card-{name}-value" class="font-weight-semibold mb-0 font-size-xs">0<\/span><\/div><div class="d-flex justify-content-end cardContent"><img src="/Resources/Images/pivotIcon.svg" onclick="Dashboard.loadChartBreakdownData(\'{name}\',\'{filtertypes}\')" class="pivoticon" /><img src="/Resources/Images/spreadsheetIcon.svg" onclick="DashboardSpreadSheet.loadChartSpreadSheetData(\'{name}\',\'{filtertypes}\')" class="spreadsheeticon" /><\/div><\/div><\/div><\/div>',TotalNetHygenistProduction:'<div id="cardStart-{name}" class="col col-lg-3 col-md-4 col-sm-6 cardStart order-{order}"><div id="card-{name}" class="card bg-success"><div class="card-body dashboardCard pt-1 pb-1"> <div class="d-flex cardHeading"><h3 class="font-weight-semibold mb-0 font-variant-smallCaps">{heading}<\/h3><div class="list-icons ml-auto"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><div class="d-flex justify-content-center cardContent"><span id="card-{name}-value" class="font-weight-semibold mb-0 font-size-xs">0<\/span><\/div><\/div><\/div><\/div>',TotalNetDoctorProduction:'<div id="cardStart-{name}" class="col col-lg-3 col-md-4 col-sm-6 cardStart order-{order}"><div id="card-{name}" class="card bg-pink-400"><div class="card-body dashboardCard pt-1 pb-1"><div class="d-flex cardHeading"><h3 class="font-weight-semibold mb-0 font-variant-smallCaps">{heading}<\/h3><div class="list-icons ml-auto"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><div class="d-flex justify-content-center cardContent"><span id="card-{name}-value" class="font-weight-semibold mb-0 font-size-xs">0<\/span><\/div><\/div><\/div><\/div>',AverageProductionPerPatient:'<div id="cardStart-{name}" class="col col-lg-3 col-md-4 col-sm-6 cardStart order-{order}"><div id="card-{name}" class="card bg-success"><div class="card-body dashboardCard pt-1 pb-1"> <div class="d-flex cardHeading"><h3 class="font-weight-semibold mb-0 font-variant-smallCaps">{heading}<\/h3><div class="list-icons ml-auto"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><div class="d-flex justify-content-center cardContent"><span id="card-{name}-value" class="font-weight-semibold mb-0 font-size-xs">0<\/span><\/div><div class="d-flex justify-content-end cardContent"><\/div><\/div><\/div><\/div>',RecareReappointmentPassive:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><\/div><div class="card-body"><div class="progressMeter"><div class="c100 p30 big green"><span>30%<\/span><div class="slice"><div class="bar"><\/div><div class="fill"><\/div><\/div><\/div><\/div><\/div><\/div><\/div>',RecareReappointmentActive:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><\/div><div class="card-body"><div class="progressMeter"><div class="c100 p41 big green"><span>41%<\/span><div class="slice"><div class="bar"><\/div><div class="fill"><\/div><\/div><\/div><\/div><\/div><\/div><\/div>',TreatmentAcceptance:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><\/div><div class="card-body"><div class="chart-container"><div class="progressMeter sm"><div class="c100 p45"><span>45%<\/span><div class="slice"><div class="bar"><\/div><div class="fill"><\/div><\/div><\/div><\/div><div class="chart smallBarGraph" id="{name}-chart"><\/div><\/div><\/div><\/div><\/div>',TreatmentScheduled:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><\/div><div class="card-body"><div class="chart-container"><div class="progressMeter sm"><div class="c100 p63"><span>63%<\/span><div class="slice"><div class="bar"><\/div><div class="fill"><\/div><\/div><\/div><\/div><div class="chart smallBarGraph" id="{name}-chart"><\/div><\/div><\/div><\/div><\/div>',CancellationAndNoShows:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"/><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"/><\/div><\/div><\/div><div class="card-body"><div class="chart-container mediumBarGraph"><div class="progress mx-auto" data-value="{percentage}"><span class="progress-left"><span class="progress-bar border-primary" style="transform: rotate(108deg);"><\/span><\/span><span class="progress-right"><span class="progress-bar border-primary" style="transform: rotate(180deg);"><\/span><\/span><div class="progress-value w-100 h-100 rounded-circle d-flex align-items-center justify-content-center"><div class="h2 font-weight-bold">{percentage}<sup class="small">%<\/sup><\/div><\/div><\/div><div class="chart" id="{name}-chart" /><\/div><\/div><div class="d-flex justify-content-end cardContent"><img src="/Resources/Images/pivotIcon.svg" onclick="Dashboard.loadChartBreakdownData(\'{name}\',\'{filtertypes}\')" class="pivoticon" /><img src="/Resources/Images/spreadsheetIcon.svg" onclick="DashboardSpreadSheet.loadChartSpreadSheetData(\'{name}\',\'{filtertypes}\')" class="spreadsheeticon" /><\/div><\/div><\/div>',UnscheduledTreatment:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><\/div><div class="card-body"><div class="chart-container"><div class="progressMeter progressMetersmall sm"><div class="c100 p20"><span>20%<\/span><div class="slice"><div class="bar"><\/div><div class="fill"><\/div><\/div><\/div><\/div><div class="chart smallBarGraph" id="{name}-chart"><\/div><input type="button" class="btn bg-blue-400 pull-right chartPatientButton" data-toggle="modal" data-target="#patientListModal" value="Patient List" /><\/div><\/div><\/div><\/div>',UnscheduledRecareActivePatient:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{name}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><\/div><div class="card-body"><div class="chart-container"><div class="progressMeter progressMetersmall sm"><div class="c100 p80"><span>80%<\/span><div class="slice"><div class="bar"><\/div><div class="fill"><\/div><\/div><\/div><\/div><div class="chart smallBarGraph" id="{name}-chart"><\/div><input type="button" class="btn bg-blue-400 pull-right chartPatientButton" data-toggle="modal" data-target="#patientListModal" value="Patient List" /><\/div><\/div><\/div><\/div>',NetCollection:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><\/div><div class="card-body"><div class="progressMeter"><div class="c100 p41 big green"><span>41%<\/span><div class="slice"><div class="bar"><\/div><div class="fill"><\/div><\/div><\/div><\/div><\/div><\/div><\/div>',ProductionBreakdown:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><\/div><div class="card-body"><div class="chart-container"><div class="chart" id="{name}-chart" data-charttype="pie"><\/div><\/div><\/div><\/div><\/div>',ServiceAnalysis:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><\/div><div class="card-body"><div class="chart-container"><div class="chart" id="{name}-chart" data-charttype="pie"><\/div><\/div><\/div><div class="d-flex justify-content-end cardContent"><img src="/Resources/Images/pivotIcon.svg" onclick="Dashboard.loadChartBreakdownData(\'{name}\',\'{filtertypes}\')" class="pivoticon" /><img src="/Resources/Images/spreadsheetIcon.svg" onclick="DashboardSpreadSheet.loadChartSpreadSheetData(\'{name}\',\'{filtertypes}\')" class="spreadsheeticon" /><\/div><\/div><\/div>',PatientGrowthRate:'<div id="cardStart-{name}" class="col-md-4 cardStart order-{order}"><div id="card-{name}" class="card dashboardGraph"><div class="card-header header-elements-inline"><h5 class="card-title font-variant-smallCaps">{heading}<\/h5><div class="header-elements"><div class="list-icons"><a class="icon-stats-growth chartButton" onclick="openChart(\'{name}\', \'{heading}\')"><\/a><a class="fa fa-pencil chartButton" onclick="Dashboard.openFilterTypesModel(\'{id}\', \'{filtertypes}\')"><\/a><a class="list-icons-item" data-action="remove" onclick="Dashboard.removeCard(this)" data-name="{name}"><\/a><\/div><\/div><\/div><div class="card-body"><div class="chart-container"><div class="chart" id="{name}-chart" data-charttype="line"><\/div><\/div><\/div><div class="d-flex justify-content-end cardContent"><img src="/Resources/Images/pivotIcon.svg" onclick="Dashboard.loadChartBreakdownData(\'{name}\',\'{filtertypes}\')" class="pivoticon" /><img src="/Resources/Images/spreadsheetIcon.svg" onclick="DashboardSpreadSheet.loadChartSpreadSheetData(\'{name}\',\'{filtertypes}\')" class="spreadsheeticon" /><\/div><\/div><\/div>',CalendarSetup:function(id){$("#"+id).daterangepicker({opens:"left",applyClass:"bg-slate-600",cancelClass:"btn-light",alwaysShowCalendars:!0,startDate:moment().subtract(29,"days"),endDate:moment(),ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]}})},PageSetup:function(){if($("#hdnIsdashboard").length){$(".headerDate").show();Dashboard.CalendarSetup("dashboardCalendar");Dashboard.CalendarSetup("dashboardModelCalendar");Dashboard.loadOfficeDropdown();Dashboard.loadProvidersDropdown();Dashboard.loadCharts();$("#dashboardCalendar").on("apply.daterangepicker",function(){Dashboard.reloadCharts();Dashboard.loadedPatients=null});$("#breakdownButtonSwitch").bootstrapSwitch();$("#breakdownButtonSwitch").on("switchChange.bootstrapSwitch",function(event,state){state?($("#breakdownbasicDetail").show(),$("#breakdownAdvancedDetail").hide(),Dashboard.loadBasicTable()):($("#breakdownAdvancedDetail").show(),$("#breakdownbasicDetail").hide(),Dashboard.loadAdvanceTable())})}},loadOfficeDropdown:function(){var officeDATAURL=window.location.origin+"/Home/GetOffices";$.getJSON(officeDATAURL,function(data){var items="";$.each(data,function(i,offices){items+="<option value='"+offices.Id+"'>"+offices.ClinicName+"<\/option>"});Dashboard.officeList=data;$("#officedropdown").html(items);$("#officedropdown").selectpicker({actionsBox:!0});$("#officedropdown").selectpicker("refresh");$("#officedropdown").selectpicker("selectAll")});$("#officedropdown").on("changed.bs.select",function(){var selectedOffices=$("#officedropdown").val();selectedOffices.length==0&&$.each(Dashboard.loadedCharts,function(i,item){$("#cardStart-"+item.chartName).remove()});Dashboard.loadProvidersDropdown();Dashboard.loadedPatients=null})},isproviderEventBound:!1,loadProvidersDropdown:function(){var selectedOffices,providerDATAURL,items;if($("#officedropdown").length)if(selectedOffices=$("#officedropdown").val(),selectedOffices.length>0){if(Layout.showLoader(),$("#providerdropdown").selectpicker({actionsBox:!0}),providerDATAURL=window.location.origin+"/Home/GetProviders?office_sequence="+selectedOffices.join(),$.getJSON(providerDATAURL,function(data){var items="";$.each(data,function(i,providers){items+="<option value='"+providers.Office_Sequence+"_"+providers.Provider+"'>"+providers.Name+"<\/option>"});$("#providerdropdown").html(items);$("#providerdropdown").selectpicker("refresh");$("#providerdropdown").selectpicker("selectAll");Layout.hideLoader()}),!Dashboard.isproviderEventBound){$("#providerdropdown").on("changed.bs.select",function(){var selectedProvider=$("#providerdropdown").val();selectedProvider.length>0?$(".draggable").draggable("enable"):$(".draggable").draggable("disable");Dashboard.reloadCharts()});Dashboard.isproviderEventBound=!0}Dashboard.loadedPatients=null}else items="",$("#providerdropdown").html(items),$("#providerdropdown").selectpicker({actionsBox:!0}),$("#providerdropdown").selectpicker("refresh")},loadCharts:function(reloadCompletePage){Layout.showLoader();$.ajax({type:"POST",url:"/Dashboard/GetCharts",data:{pageName:"PracticeMetrics"},success:function(data){data.Success&&(Dashboard.loadedCharts=[],Dashboard.charts=data.Data,Dashboard.userCharts=data.UserCharts,$("#ChartSelectionOptions").html(`<div class="row top">

                    </div>
                    <div class="row center">

                    </div>
                    <div class="row bottom">

                    </div>`),$.each(data.Data,function(i,data){let userCharts=Dashboard.userCharts.filter(x=>x.Chart_Id==data.ID);if(userCharts.length>0){let filterTypes=userCharts[0].FilterTypes;filterTypes==null&&filterTypes==""&&(filterTypes=data.FilterTypes);Dashboard.loadedCharts.push({chartId:data.ID,chartName:data.Name,chartTitle:data.Title,position:data.Position,order:data.Order,filtertypes:filterTypes})}else{var html=Dashboard.selectionHTML.replace(/{position}/g,data.Position).replace(/{order}/g,data.Order).replace(/{title}/g,data.Title).replace(/{id}/g,data.ID).replace(/{name}/g,data.Name).replace(/{filtertypes}/g,data.FilterTypes).replace(/{icon}/g,data.Icon);$("#ChartSelectionOptions ."+data.Position).append(html)}}),Dashboard.initializeDragDrop(),$("#providerdropdown").selectpicker("selectAll"),reloadCompletePage&&Dashboard.reloadCharts(),Layout.hideLoader())},error:function(errorData){Dashboard.onError(errorData)}})},loadChartsData:function(chartName,chartType,types){var selectedProvider=$("#providerdropdown").val(),selectedOffices=$("#officedropdown").val();selectedOffices.length>0&&selectedProvider.length>0&&$.ajax({type:"POST",url:"/Dashboard/LoadChartData",data:{chartName:chartName,offices:selectedOffices,providers:selectedProvider,startDate:moment($("#dashboardCalendar").data("daterangepicker").startDate).format("YYYY-MM-DD"),endDate:moment($("#dashboardCalendar").data("daterangepicker").endDate).format("YYYY-MM-DD"),types:types},success:function(data){var formatter;if(data.Success)try{data.hasMultipleRecords?chartType.includes("PieOnly")?Dashboard.PieChart(chartName+"-chart",data.Data):chartType.includes("BarOnly")&&Dashboard.BarChart(chartName+"-chart",data.Data):data.IsCurrency?(formatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),$("#card-"+chartName+"-value").html(formatter.format(data.Data).replace(".00",""))):data.Data>1e3?(formatter=new Intl.NumberFormat("en-US"),$("#card-"+chartName+"-value").html(formatter.format(data.Data))):$("#card-"+chartName+"-value").html(data.Data)}catch(e){}Layout.hideCardLoader("card-"+chartName)},error:function(errorData){Dashboard.onError(errorData);Layout.hideCardLoader("card-"+chartName)}})},loadChartBreakdownData:function(chartName,types){Dashboard.setting.isBreakdownTable=!0;Dashboard.setting.isSpreadsheetTale=!1;Dashboard.setting.loadedChartName=chartName;Dashboard.loadModelData(chartName,types)},loadModelData:function(chartName,types){var selectedProvider=$("#providerdropdown").val(),selectedOffices=$("#officedropdown").val();selectedOffices.length>0&&selectedProvider.length>0&&($("#breakdownDetail").html(""),Layout.showLoader(),$.ajax({type:"POST",url:"/Dashboard/LoadChartDataBreakdown",data:{chartName:chartName,offices:selectedOffices,providers:selectedProvider,startDate:moment($("#dashboardCalendar").data("daterangepicker").startDate).format("YYYY-MM-DD"),endDate:moment($("#dashboardCalendar").data("daterangepicker").endDate).format("YYYY-MM-DD"),types:types},success:function(data){data.Success&&(Dashboard.destoryLoadedBreakdownGrid(),data.Data=Dashboard.addOfficeNameInList(data.Data),Dashboard.chartsDetailData=data.Data,$("#chartBreakdown").modal("show"));Layout.hideLoader()},error:function(errorData){Dashboard.onError(errorData);Layout.hideLoader()}}))},loadBasicTable:function(){if(Dashboard.breakdownTableBasic!=null)try{Dashboard.breakdownTableBasic.destroy();$("#breakdownBasic-table").html("")}catch(e){}Dashboard.breakdownTableBasic=$("#breakdownBasic-table").kendoGrid({dataSource:{data:Dashboard.chartsDetailData,group:[{field:"OfficeName",title:officeNameSetting,dir:"asc"},{field:"InvoiceDateString",title:"Invoice Date",dir:"asc"},{field:"InvoiceTypeDetail",title:"Invoice Type",dir:"asc"},{field:"Name",title:"Patient",dir:"asc"},],sort:{field:"InvoiceDateString",dir:"desc"}},selectable:"multiple row",pageable:{buttonCount:5},scrollable:!0,groupable:!0,columns:[{field:"PatAmount",title:patAmountSetting,format:"{0:c}"},{field:"InsAmount",title:insAmountSetting,format:"{0:c}"},{field:"OfficeName",groupHeaderTemplate:officeNameSetting,title:officeNameSetting},{field:"InvoiceTypeDetail",groupHeaderTemplate:"Invoice Type"},{field:"InvoiceDateString",groupHeaderTemplate:"Invoice Date"}]})},loadAdvanceTable:function(){if(Dashboard.breakdownTable!=null)try{Dashboard.breakdownTable.destroy();$("#breakdown-table").html("");Dashboard.breakdownTableConfiguration.data("kendoPivotConfigurator").destroy();$("#configurator").html("")}catch(e){}Dashboard.breakdownTable=$("#breakdown-table").kendoPivotGrid({filterable:!0,columnWidth:120,height:570,dataSource:{data:Dashboard.chartsDetailData,schema:{model:{fields:{Name:{type:"string"},InvoiceDateString:{type:"string",label:"Invoice Date"},InvoiceTypeDetail:{type:"string",label:"Invoice Type"},PatAmount:{type:"number",label:patAmountSetting},InsAmount:{type:"number",label:insAmountSetting},Total:{type:"number"},OfficeName:{type:"string"}}},cube:{dimensions:{OfficeName:{caption:officeNameSetting},InvoiceDateString:{caption:"All Dates"},InvoiceTypeDetail:{caption:"All Types"},Name:{caption:"All Patients"}},measures:{"Sum PatAmount":{field:"PatAmount",format:"{0:c}",aggregate:"sum"},"Sum InsAmount":{field:"InsAmount",format:"{0:c}",aggregate:"sum"},Total:{field:"TotalAmount",format:"{0:c}",aggregate:"sum"}}}},columns:[],rows:[{name:"OfficeName",title:officeNameSetting},{name:"InvoiceTypeDetail",label:"Type",title:"Type"},{name:"Name"},{name:"InvoiceDateString",title:"Invoice Date"},],measures:["Sum PatAmount","Sum InsAmount","Total"]}}).data("kendoPivotGrid");Dashboard.breakdownTableConfiguration=$("#configurator").kendoPivotConfigurator({dataSource:Dashboard.breakdownTable.dataSource,filterable:!0,height:570})},loadServiceTable:function(){Dashboard.chartsDetailData!=null&&(Dashboard.breakdownGrid=$("#breakdownGrid").kendoGrid({dataSource:{data:Dashboard.chartsDetailData,group:[{field:"OfficeName",dir:"asc"},{field:"ProviderName",dir:"asc"},{field:"CodeCategory",dir:"asc"}],sort:{field:"InvoiceDateString",dir:"desc"}},selectable:"multiple row",pageable:{buttonCount:5},scrollable:!0,groupable:!0,columns:[{field:"InvoiceDateString",title:"Invoice Date"},{field:"ServiceCode",title:"Code"},{field:"PatAmount",title:patAmountSetting,format:"{0:c}"},{field:"InsAmount",title:insAmountSetting,format:"{0:c}"}]}))},loadCancellationAndNoShows:function(){Dashboard.breakdownGrid=$("#breakdownGrid").kendoGrid({dataSource:{data:Dashboard.chartsDetailData,group:[{field:"OfficeName",dir:"asc"},{field:"ProviderName",dir:"asc"}],sort:{field:"Office_Sequence",dir:"desc"}},selectable:"multiple row",pageable:{buttonCount:5},scrollable:!0,groupable:!0,columns:[{field:"OfficeName",title:"Office"},{field:"ProviderName",title:"Provider"},{field:"PatientName",title:"Patient"},{field:"ContactDateString",title:"Contact Date",format:"{0:MM/dd/yyyy}"},{field:"Job",title:"Job Code"},{field:"TimeString",title:"Time"}]})},addOfficeNameInList:function(data){return $.each(data,function(index,item){var officeDetail=Dashboard.officeList.filter(x=>x.Id==item.Office_Sequence);try{officeDetail.length>0&&(data[index].OfficeName=officeDetail[0].ClinicName);data[index].Name=data[index].Title+" "+data[index].LastName+" "+data[index].FirstName}catch(e){}}),data},destoryLoadedBreakdownGrid:function(){Dashboard.breakdownTable!=null&&Dashboard.breakdownTable.destroy();try{DashboardSpreadSheet.spreadsheetTable.empty();$("#spreadsheet-Table").html("")}catch(e){}try{Dashboard.breakdownGrid.data("kendoGrid").dataSource.data([]);$("#breakdownGrid").html("")}catch(e){}},chartSelection:function(id,name,chartTitle,position,order,types,addToDatabase){var data=Dashboard.charts.filter(x=>x.ID==id),html,chartType;data.length>0&&(data=data[0],html=Dashboard[name],html=html.replace(/{heading}/g,chartTitle),html=html.replace(/{order}/g,order),html=html.replace(/{name}/g,name),html=html.replace(/{filtertypes}/g,types),html=html.replace(/{id}/g,data.ID),$(".droppable ."+position).append(html),Layout.showCardLoader("card-"+name),chartType=data.Chart_Type,Dashboard.loadChartsData(name,chartType,types),chartType.includes("PieOnly")||chartType.includes("LineNCircular")||chartType.includes("BarOnly")||chartType.includes("CircularOnly")||chartType.includes("CardOnly")||Layout.hideCardLoader("card-"+name));addToDatabase&&$.ajax({type:"POST",url:"/Dashboard/AddCard",data:{chartId:id,addToDatabase:addToDatabase,defaultFilterTypes:data.FilterTypes},success:function(){},error:function(errorData){Dashboard.onError(errorData)}})},selectedchartname:"",openFilterTypesModel:function(id,selectedTypes){var curHtml,description,allowedAdditionalTypes;$("#allowedFilterTypes").multiselect("destroy");Dashboard.selectedchartname=id;selectedTypes=selectedTypes.length>0?selectedTypes.split(","):[];$("#filterTypesModal").modal("show");const allowedFilterTypes=Dashboard.charts.find(x=>x.ID==id).AvailableFilterTypes.split(",");let html="";for(let i=0;i<allowedFilterTypes.length;i++)curHtml=Dashboard.filterTypeHTML.replace(/{value}/g,allowedFilterTypes[i]),description=Dashboard.mapping.find(x=>x.Type==allowedFilterTypes[i]),curHtml=description==undefined||description==null?curHtml.replace(/{name}/g,allowedFilterTypes[i]):description.Description==""?curHtml.replace(/{name}/g,allowedFilterTypes[i]):curHtml.replace(/{name}/g,description.Description),html+=curHtml;$("#allowedFilterTypes").html(html);$("#allowedFilterTypes").multiselect("select",selectedTypes);allowedAdditionalTypes="";for(let i=0;i<selectedTypes.length;i++)allowedFilterTypes.includes(selectedTypes[i])||selectedTypes[i]!=null&&selectedTypes[i]!="null"&&selectedTypes[i]!=""&&(allowedAdditionalTypes+=selectedTypes[i]+",");$("#txtAdditionalFilters").val(allowedAdditionalTypes.replace(/(^\s*,)|(,\s*$)/g,""))},saveFilterTypeOptions:function(){const selectFilterTypes=$("#allowedFilterTypes").val();let filterTypes="";for(let i=0;i<selectFilterTypes.length;i++)filterTypes+=selectFilterTypes[i]+",";filterTypes=(filterTypes+$("#txtAdditionalFilters").val()).replace(/(^\s*,)|(,\s*$)/g,"");Layout.showLoader();$.ajax({type:"POST",url:"/Dashboard/UpdateCardFilterTypes",data:{chartId:Dashboard.selectedchartname,filterTypes:filterTypes},success:function(data){data.Success&&$("#filterTypesModal").modal("hide");Dashboard.loadCharts(!0);Layout.hideLoader()},error:function(errorData){Dashboard.onError(errorData);Layout.hideLoader()}})},PieChart:function(id,data){for(var donut_chart_element,donut_chart,model=[],i=0;i<data.length;i++)model.push([data[i].xLabel,data[i].yValue]);data==null?(donut_chart_element=document.getElementById(id),donut_chart_element&&(donut_chart=c3.generate({bindto:donut_chart_element,color:{pattern:["#3F51B5","#FF9800","#4CAF50","#00BCD4","#F44336"]},data:{columns:[["data1",10],["data2",40],["data3",50],],type:"donut"},donut:{}}))):(donut_chart_element=document.getElementById(id),donut_chart_element&&(donut_chart=c3.generate({bindto:donut_chart_element,color:{pattern:["#3F51B5","#FF9800","#4CAF50","#00BCD4","#F44336"]},data:{columns:model,keys:{x:"xLabel",value:["yValue"]},type:"donut"},donut:{}})))},BarChart:function(id,data){function resize(){myChart.draw(0,!0)}var element,model,i,svg,myChart,x,y;if($("#"+id).html(""),element=document.getElementById(id),model=JSON.parse(data),uModel=model,id==="CancellationAndNoShows-chart"){for(i=0;i<model.length;i++)model[i].order=i;svg=dimple.newSvg(element,"100%");svg.attr("width","100%").attr("height","100%");myChart=new dimple.chart(svg,model);myChart.setBounds("10%",0,"90%","100%");myChart.setMargins(55,5,0,50);x=myChart.addCategoryAxis("x",["contactDate"]);x.addOrderRule("order");myChart.addMeasureAxis("y","count");myChart.addSeries("status",dimple.plot.bar);myChart.draw()}else{for(i=0;i<data.length;i++)model.push({Date:data[i].xLabel,Count:data[i].yValue});svg=dimple.newSvg(element,"100%");svg.attr("width","100%").attr("height","100%");myChart=new dimple.chart(svg,model);myChart.setBounds("10%",0,"90%","100%");myChart.setMargins(55,5,0,50);x=myChart.addCategoryAxis("x","Date");x.addOrderRule("order");y=myChart.addMeasureAxis("y","Count");myChart.addSeries(null,dimple.plot.bar);x.fontSize="12";y.fontSize="12";x.fontFamily="Roboto";y.fontFamily="Roboto";myChart.draw();$(window).on("resize",resize);$(".sidebar-control").on("click",resize)}$(".sidebar-control").on("click",function(){bar_chart.resize()})},removeCard:function(e){var target=$(e),dataId=target.data("name");target.hasClass("disabled")||target.closest(".card").slideUp({duration:150,start:function(){target.addClass("d-block")},complete:function(){var data,currentChart,html;target.closest(".cardStart").remove();data=Dashboard.charts.filter(x=>x.Name==dataId);data.length>0&&(data=data[0],currentChart=Dashboard.loadedCharts.filter(x=>x.chartName==dataId),currentChart.length>0&&Dashboard.loadedCharts.splice(Dashboard.loadedCharts.indexOf(currentChart[0]),1),Dashboard.RemoveCardFromdatabase(data.ID),html=Dashboard.selectionHTML.replace(/{position}/g,data.Position).replace(/{order}/g,data.Order).replace(/{title}/g,data.Title).replace(/{id}/g,data.ID).replace(/{name}/g,dataId).replace(/{filtertypes}/g,data.FilterTypes).replace(/{icon}/g,data.Icon),$("#ChartSelectionOptions ."+data.Position).append(html),Dashboard.initializeDragDrop())}})},RemoveCardFromdatabase:function(chartId){$.ajax({type:"POST",url:"/Dashboard/RemoveChart",data:{chartId:chartId},success:function(data){data.Success},error:function(errorData){Dashboard.onError(errorData)}})},initializeDragDrop:function(){$(".draggable").draggable({revert:!0});$(".droppable").droppable({drop:function(event,ui){ui.draggable.detach();var chartId=ui.draggable.data("id"),chartName=ui.draggable.data("name"),chartTitle=ui.draggable.data("title"),position=ui.draggable.data("position"),order=ui.draggable.data("order"),filtertypes=ui.draggable.data("filtertypes");Dashboard.loadedCharts.push({chartId:chartId,chartName:chartName,chartTitle:chartTitle,position:position,order:order,filtertypes:filtertypes});Dashboard.chartSelection(chartId,chartName,chartTitle,position,order,filtertypes,!0)}})},reloadCharts:function(){var selectedProvider=$("#providerdropdown").val(),selectedOffices=$("#officedropdown").val();selectedProvider.length>0&&selectedOffices.length>0?$.each(Dashboard.loadedCharts,function(i,item){$("#cardStart-"+item.chartName).remove();Dashboard.chartSelection(item.chartId,item.chartName,item.chartTitle,item.position,item.order,item.filtertypes,!1)}):$.each(Dashboard.loadedCharts,function(i,item){$("#cardStart-"+item.chartName).remove()})},onError:function(errorData){console.log(errorData)},getPatientList:function(){if(Dashboard.loadedPatients==null){var selectedProvider=$("#providerdropdown").val(),selectedOffices=$("#officedropdown").val();Layout.showLoader();$.ajax({type:"POST",url:"/Dashboard/LoadPatientList",data:{offices:selectedOffices,providers:selectedProvider,startDate:moment($("#dashboardCalendar").data("daterangepicker").startDate).format("YYYY-MM-DD"),endDate:moment($("#dashboardCalendar").data("daterangepicker").endDate).format("YYYY-MM-DD")},success:function(data){if(data.Success){Dashboard.loadedPatients=data.Data;var html="";$.each(data.Data,function(i,patient){html+='<a href="#" class="dropdown-item" onclick="Dashboard.loadPatientDetail(\''+patient.Office_Sequence+"','"+patient.PatientNumber+"','"+patient.LastName+" "+patient.FirstName+"',this)\">"+patient.LastName+" "+patient.FirstName+"<\/a>"});$("#patientListDiv").html(html);$("#patientCount").html(data.Data.length);data.Data.length>0&&$("#patientListDiv a:first").click()}Layout.hideLoader()},error:function(errorData){Dashboard.onError(errorData);Layout.hideLoader()}})}},loadPatientDetail:function(officeSequence,id,patientName,obj){$("#patientListHeading").html(patientName);$("#patientListDiv a").removeClass("selectedPatient");$(obj).addClass("selectedPatient");Dashboard.loadPatientProfile(id,officeSequence);Dashboard.loadPatientAppointment(id,officeSequence);Dashboard.loadPatientTreatment(id,officeSequence)},loadPatientProfile:function(id,officeSequence){Layout.showLoader();$.ajax({type:"POST",url:"/Dashboard/LoadPatientProfile",data:{id:id,officeSequence:officeSequence},success:function(data){var item,html;if(data.Success){if(item=data.Data,item!=null){if(item.Age!=null&&!isNaN(item.Age))try{$("#lblPatientAge").html(Number(item.Age).toFixed(0))}catch(e){}item.Sex.toLowerCase()=="f"?$("#lblSex").html("Female"):$("#lblSex").html("Male");$("#lblMaritialStatus").html(item.MaritalStatus);$("#lblInsuranceProvider").html(item.InsuranceProvider);$("#lblPatientAddress").html(item.Address);$("#lblPatientHomePhone").html(item.HomeNumber);$("#lblPatientWorkPhone").html(item.WorkPhone);$("#lblPatientOtherPhone").html(item.OtherPhone);$("#lblTotalOutstandingCashBalance").html("$XXXX");$("#lblTotalOutstandingInsuranceBalance").html("$XXXX");$("#lblOutstandingBalance").html("$XXXXX")}else $("#lblPatientAge").html(""),$("#lblSex").html(""),$("#lblMaritialStatus").html(""),$("#lblInsuranceProvider").html(""),$("#lblPatientAddress").html(""),$("#lblPatientHomePhone").html(""),$("#lblPatientWorkPhone").html(""),$("#lblPatientOtherPhone").html(""),$("#lblTotalOutstandingCashBalance").html(""),$("#lblTotalOutstandingInsuranceBalance").html(""),$("#lblOutstandingBalance").html("");html=""}Layout.hideLoader()},error:function(errorData){Dashboard.onError(errorData);Layout.hideLoader()}})},loadPatientAppointment:function(id,officeSequence){$.ajax({type:"POST",url:"/Dashboard/LoadPatientAppointment",data:{id:id,officeSequence:officeSequence,startDate:moment($("#dashboardCalendar").data("daterangepicker").startDate).format("YYYY-MM-DD"),endDate:moment($("#dashboardCalendar").data("daterangepicker").endDate).format("YYYY-MM-DD")},success:function(data){if(data.Success){var html="",totalAmount=0;$.each(data.Data,function(i,appointment){totalAmount+=appointment.Fee;html+="<tr><td>"+appointment.InvoiceDate+"<\/td><td>"+appointment.Provider+"<\/td><td>"+appointment.Procedure+"<\/td><td>"+appointment.Status+"<\/td><td>"+appointment.Fee+"<\/td><\/tr>"});html+="<tr><td><\/td><td><\/td><td><\/td><td><\/td><td>$"+totalAmount+"<\/td><\/tr>";$("#patientAppointmentDiv").html(html)}},error:function(errorData){Dashboard.onError(errorData)}})},loadPatientTreatment:function(id,officeSequence){$.ajax({type:"POST",url:"/Dashboard/LoadPatientTreatment",data:{id:id,officeSequence:officeSequence,startDate:moment($("#dashboardCalendar").data("daterangepicker").startDate).format("YYYY-MM-DD"),endDate:moment($("#dashboardCalendar").data("daterangepicker").endDate).format("YYYY-MM-DD")},success:function(data){if(data.Success);},error:function(errorData){Dashboard.onError(errorData)}})},loadMappingDetail:function(){$.ajax({type:"POST",url:"/Dashboard/GetMappingDetail",data:{},success:function(data){data.Success&&(Dashboard.mapping=data.Data)},error:function(errorData){Dashboard.onError(errorData)}})}};$(document).ready(function(){Dashboard.PageSetup();Dashboard.loadMappingDetail();$("#chartBreakdown").on("show.bs.modal",function(){Dashboard.setting.isBreakdownTable?($("#spreadsheetDetailDiv").hide(),Dashboard.setting.loadedChartName=="TotalNetProduction"||Dashboard.setting.loadedChartName=="TotalNetHygenistProduction"||Dashboard.setting.loadedChartName=="TotalNetDoctorProduction"||Dashboard.setting.loadedChartName=="AverageProductionPerPatient"||Dashboard.setting.loadedChartName=="TotalPaymentReceipt"||Dashboard.setting.loadedChartName=="TotalNetPaymentReceipt"?($("#breakdownDetailDiv").show(),$("#breakdownDiv").hide(),$("#breakdownButtonSwitch").bootstrapSwitch("state",!0)):($("#breakdownDetailDiv").hide(),$("#breakdownDiv").show())):($("#breakdownDetailDiv").hide(),$("#breakdownDiv").hide(),$("#spreadsheetDetailDiv").show());setTimeout(function(){if(Dashboard.setting.isBreakdownTable){try{$('[id="breakdownButtonSwitch"]').is(":checked")?Dashboard.loadBasicTable():Dashboard.loadAdvanceTable()}catch(e){}Dashboard.setting.loadedChartName==="ServiceAnalysis"?Dashboard.loadServiceTable():Dashboard.setting.loadedChartName==="CancellationAndNoShows"&&Dashboard.loadCancellationAndNoShows()}else Dashboard.setting.isSpreadsheetTale&&DashboardSpreadSheet.setupSpreadSheetGrid()},1e3)})});DashboardSpreadSheet={spreadsheetTable:null,loadChartSpreadSheetData:function(chartName,types){Dashboard.setting.isBreakdownTable=!1;Dashboard.setting.isSpreadsheetTale=!0;Dashboard.setting.loadedChartName=chartName;Dashboard.loadModelData(chartName,types)},setupSpreadSheetGrid:function(){Dashboard.chartsDetailData!=null&&(DashboardSpreadSheet.spreadsheetTable=$("#spreadsheet-Table").kendoSpreadsheet({excel:{proxyURL:"/Dashboard/Index_Proxy"},pdf:{proxyURL:"/Dashboard/Index_Proxy"},sheets:[{name:"Breakdown",rows:[...DashboardSpreadSheet.organizeResults(Dashboard.chartsDetailData,Dashboard.setting.loadedChartName)],columns:[{width:100},{width:215},{width:115},{width:115},{width:115},{width:115},{width:115},{width:155}]}]}))},organizeResults:function(data,chartName){return chartName=="ServiceAnalysis"?DashboardSpreadSheet.organizedDataForServiceAnalysisChart(data):chartName=="CancellationAndNoShows"?DashboardSpreadSheet.organizedDataForCancellationAndNoShowsChart(data):chartName=="TotalNetProduction"||chartName=="TotalNetHygenistProduction"||chartName=="TotalNetDoctorProduction"||chartName=="AverageProductionPerPatient"||chartName=="TotalPaymentReceipt"||chartName=="TotalNetPaymentReceipt"?DashboardSpreadSheet.organizedDataForSmallCharts(data):null},organizedDataForServiceAnalysisChart:function(data){var resultset=[],i,dataSet,record;for(resultset.push({height:25,cells:[{value:"Office Name",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Provider Name",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Code Category",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Service Code",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Invoice Date",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Invoice Number",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"PatAmount",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"InsAmount",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"}]}),i=0;i<data.length;i++)dataSet=data[i],record={cells:[{value:dataSet.OfficeName,textAlign:"center",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.ProviderName,background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.CodeCategory,textAlign:"center",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.ServiceCode,textAlign:"center",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.InvoiceDateString,background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.InvoiceNumber,background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.PatAmount,format:"$#,##0.00",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.InsAmount,format:"$#,##0.00",background:"rgb(255,255,255)",color:"rgb(0,62,117)"}]},resultset.push(record);return resultset},organizedDataForCancellationAndNoShowsChart:function(data){var resultset=[],i,dataSet,record;for(resultset.push({height:25,cells:[{value:"Office Name",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Provider Name",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Patient Name",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Contact Date",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Job",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Time",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"}]}),i=0;i<data.length;i++)dataSet=data[i],record={cells:[{value:dataSet.OfficeName,textAlign:"center",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.ProviderName,background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.PatientName,textAlign:"center",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.ContactDateString,textAlign:"center",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.Job,background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.TimeString,background:"rgb(255,255,255)",color:"rgb(0,62,117)"}]},resultset.push(record);return resultset},organizedDataForSmallCharts:function(data){var resultset=[],i,dataSet,record;for(resultset.push({height:25,cells:[{value:officeNameSetting,background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Invoice Date",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Invoice Type",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:"Patient",background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:patAmountSetting,background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"},{value:insAmountSetting,background:"rgb(167,214,255)",textAlign:"center",color:"rgb(0,62,117)"}]}),i=0;i<data.length;i++)dataSet=data[i],record={cells:[{value:dataSet.OfficeName,textAlign:"center",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.InvoiceDateString,background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.InvoiceTypeDetail,textAlign:"center",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.Name,textAlign:"center",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.PatAmount,format:"$#,##0.00",background:"rgb(255,255,255)",color:"rgb(0,62,117)"},{value:dataSet.InsAmount,format:"$#,##0.00",background:"rgb(255,255,255)",color:"rgb(0,62,117)"}]},resultset.push(record);return resultset}};